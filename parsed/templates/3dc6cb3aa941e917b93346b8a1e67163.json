{
  "components/halothemes/home/home-best-sellers": "<section class=\"container best-sellers\">\r\n    <h2 class=\"heading\">Pro-Guide Best Sellers</h2>\r\n    <img class=\"icon-loading\" src=\"{{cdn 'img/loading.svg'}}\" alt=\"Icon Loading\">\r\n</section>\r\n\r\n<style>\r\n    .container.best-sellers {\r\n        padding: 40px 20px;\r\n        background: #F1F1F1;\r\n    }\r\n\r\n    .best-sellers .heading {\r\n        color: #231F20;\r\n        text-align: center;\r\n        font-family: Vox;\r\n        font-size: 27px;\r\n        font-style: normal;\r\n        font-weight: 400;\r\n        line-height: 35px;\r\n        margin: 0;\r\n    }\r\n\r\n    .best-sellers .slick-list.draggable {\r\n        margin-top: 30px;\r\n    }\r\n\r\n    .best-sellers .slick-track {\r\n        display: flex;\r\n        gap: 20px;\r\n    }\r\n\r\n    .best-seller-product.slick-slide {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        justify-content: space-between;\r\n        gap: 15px;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .product-card-body {\r\n        width: 100%;\r\n        text-decoration: none;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .product-details {\r\n        margin-top: 15px;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .product-details .brand-name {\r\n        color: #231F20;\r\n        font-family: 'helvetic-regular';\r\n        font-size: 18px;\r\n        font-style: normal;\r\n        font-weight: 700;\r\n        line-height: 25px;\r\n        letter-spacing: 0.4px;\r\n        margin: 0;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .product-details .sku {\r\n        overflow: hidden;\r\n        color: #231F20;\r\n        text-overflow: ellipsis;\r\n        font-family: 'helvetic-regular';\r\n        font-size: 14px;\r\n        font-style: normal;\r\n        font-weight: 400;\r\n        line-height: 20px; /* 142.857% */\r\n        letter-spacing: 0.4px;\r\n        margin: 5px 0 0 0;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .product-details .price {\r\n        color: #231F20;\r\n        font-family: 'helvetic-regular';\r\n        font-size: 18px;\r\n        font-style: normal;\r\n        font-weight: 500;\r\n        line-height: 25px; /* 138.889% */\r\n        letter-spacing: 0.4px;\r\n        margin: 10px 0 0 0;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .call-to-action.add-to-cart {\r\n        display: flex;\r\n        height: 50px;\r\n        padding: 0px 15px;\r\n        justify-content: center;\r\n        align-items: center;\r\n        gap: 9px;\r\n        align-self: stretch;\r\n        border-radius: 5px;\r\n        border: 2px solid #CE0E2D;\r\n        background: #FFF;\r\n        text-decoration: none;\r\n    }\r\n\r\n    .best-sellers .best-seller-product .call-to-action.add-to-cart .text {\r\n        color: #CE0E2D;\r\n        font-family: 'helvetic-regular';\r\n        font-size: 18px;\r\n        font-style: normal;\r\n        font-weight: 700;\r\n        line-height: 25px; /* 138.889% */\r\n        letter-spacing: 0.4px;\r\n        text-align: center;\r\n    }\r\n\r\n\r\n    .best-sellers .best-seller-product-image {\r\n        width: 100%;\r\n        height: 170px;\r\n        object-fit: contain;\r\n    }\r\n\r\n    .best-sellers .icon-loading {\r\n        width: 300px;\r\n    }\r\n\r\n    .best-sellers .slick-next::before, .best-sellers .slick-prev::before {\r\n        content: '';\r\n        background-image: none;\r\n        background-position: 0%;\r\n        background-repeat: unset;\r\n        background-size: 0;\r\n        display: none;\r\n        height: 0;\r\n        width: 0;\r\n        opacity: 0;\r\n        font-family: 'slick';\r\n        font-size: 0px;\r\n        line-height: 0;\r\n        opacity: 0;\r\n        color: red;\r\n        -webkit-font-smoothing: antialiased;\r\n    }\r\n\r\n    .best-sellers .slick-next:hover:not(.slick-disabled), .best-sellers .slick-next:focus:not(.slick-disabled), .best-sellers .slick-prev:hover:not(.slick-disabled), .best-sellers .slick-prev:focus:not(.slick-disabled) {\r\n        border: none;\r\n        background-color: transparent;\r\n    }\r\n\r\n    .best-sellers .slick-next {\r\n        right: 0;\r\n    }\r\n\r\n    .best-sellers .slick-prev {\r\n        left: 0;\r\n    }\r\n\r\n    .best-sellers .slick-arrow {\r\n        background-color: transparent;\r\n        border: none;\r\n        width: 24px;\r\n        height: 24px;\r\n        padding: 4.8px;\r\n        aspect-ratio: 1 / 1;\r\n    }\r\n\r\n    .star-rating {\r\n      display: flex;\r\n      gap: 4px;\r\n      align-items: center;\r\n    }\r\n  \r\n    .star {\r\n      position: relative;\r\n      width: 16px;\r\n      height: 17px;\r\n    }\r\n  \r\n    .star svg {\r\n      display: block;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  \r\n    .star .back-star {\r\n      fill: #ccc; /* Gray background star */\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n    }\r\n  \r\n    .star .front-star-wrapper {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      overflow: hidden;\r\n    }\r\n  \r\n    .review-count {\r\n      font-size: 14px;\r\n      color: #555;\r\n      margin-left: 8px;\r\n    }\r\n\r\n    @media (min-width: 993px) {\r\n        .container.best-sellers {\r\n            padding: 80px 65px;\r\n        }\r\n        .best-sellers .slick-list.draggable {\r\n            margin-top: 40px;\r\n        }\r\n        .best-sellers .heading {\r\n            font-size: 40px;\r\n            font-style: normal;\r\n            font-weight: 400;\r\n            line-height: 45px; /* 112.5% */\r\n        }\r\n        .best-sellers .best-seller-product-image {\r\n            height: 220px;\r\n            object-fit: unset;\r\n        }\r\n        .best-sellers .best-seller-product .product-details .brand-name {\r\n            font-size: 24px;\r\n            font-style: normal;\r\n            font-weight: 700;\r\n            line-height: normal;\r\n            letter-spacing: 0.4px;\r\n        }\r\n        .best-sellers .best-seller-product .product-details .sku {\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n            font-size: 20px;\r\n            font-style: normal;\r\n            font-weight: 400;\r\n            line-height: normal;\r\n            letter-spacing: 0.4px;\r\n        }\r\n        .best-sellers .best-seller-product .product-details .price {\r\n            font-size: 20px;\r\n            font-style: normal;\r\n            font-weight: 400;\r\n            line-height: 25px; /* 125% */\r\n            letter-spacing: 0.4px;\r\n        }\r\n        .best-sellers .slick-arrow {\r\n            width: 45px;\r\n            height: 45px;\r\n            padding: 11px 10px 10px 11px;\r\n            border-radius: 10px;\r\n            border: 1px solid rgba(120, 120, 120, 0.40);\r\n            background: #FFF;\r\n        }\r\n        .best-sellers .slick-arrow:hover {\r\n            border-radius: 10px !important;\r\n            border: 1px solid rgba(120, 120, 120, 0.40) !important;\r\n            background: #FFF !important;\r\n        }\r\n        .best-sellers .slick-arrow svg {\r\n            width: 24px;\r\n            height: 24px;\r\n            aspect-ratio: 1 / 1;\r\n        }\r\n        .best-sellers .slick-next {\r\n            right: 10px;\r\n        }\r\n        .best-sellers .slick-prev {\r\n            left: 20px;\r\n        }\r\n    }\r\n\r\n    @media (min-width: 1440px) {\r\n        .best-sellers .best-seller-product-image {\r\n            height: 300px;\r\n            object-fit: unset;\r\n        }\r\n    }\r\n</style>\r\n  \r\n\r\n<style>\r\n    .rating-container {\r\n            display: flex;\r\n            align-items: center;\r\n            margin-top: 5px;\r\n        }\r\n        \r\n        .star {\r\n            position: relative;\r\n            width: 12px;\r\n            height: 12px;\r\n            display: inline-block;\r\n        }\r\n        \r\n        .star svg {\r\n            width: 100%;\r\n            height: 100%;\r\n            fill: #fff;\r\n            stroke: #ce0e2d;\r\n            stroke-width: 2.5px;\r\n        }\r\n        \r\n        .star .filled {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            height: 100%;\r\n            overflow: hidden;\r\n            z-index: 1;\r\n        }\r\n        \r\n        .star .filled svg {\r\n            fill: #CE0E2D;\r\n            width: 12px;\r\n            height: 12px;\r\n        }\r\n        \r\n        /* Larger screens (992px and above) */\r\n        @media (min-width: 992px) {\r\n            .star {\r\n                width: 16px;\r\n                height: 16px;\r\n            }\r\n            \r\n            .star .filled svg {\r\n                width: 16px;\r\n                height: 16px;\r\n            }\r\n        }\r\n        \r\n        .rating-text {\r\n            color: #787878;\r\n            font-family: 'helvetic-regular';\r\n            font-size: 14px;\r\n            font-style: normal;\r\n            font-weight: 400;\r\n            line-height: 20px; /* 142.857% */\r\n            letter-spacing: 0.4px;\r\n            margin-left: 4px;\r\n        }\r\n</style>\r\n\r\n<script>\r\n    async function ApiFetch(method, url, data, graphToken) {\r\n        try {\r\n            const response = await fetch(url, {\r\n                method: method,\r\n                credentials: 'same-origin',\r\n                headers: {\r\n                \"Content-Type\": 'application/json',\r\n                \"Authorization\": `Bearer ${graphToken}`\r\n                },\r\n                body: JSON.stringify(data)\r\n            })\r\n\r\n            const result = await response.json()\r\n            return [result, 0]\r\n        } catch (error) {\r\n            console.log(error)\r\n            return [0, error]\r\n        }\r\n    }\r\n\r\n    function initializeBestSellersSlider () {\r\n        console.log('best-sellers:', document.querySelector('.best-sellers'));\r\n        $('.best-sellers').slick({\r\n            arrows: true,\r\n            dots: false,\r\n            autoPlay: false,\r\n            mobileFirst: true,\r\n            slidesToShow: 2,\r\n            slidesToScroll: 2,\r\n            infinite: true,\r\n            pauseOnHover: true,\r\n            slide: '[data-best-seller-slide]',\r\n            nextArrow: '<button type=\"button\" class=\"slick-next slick-arrow-custom\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"19\" height=\"20\" viewBox=\"0 0 19 20\" fill=\"none\"><path d=\"M15.6114 9.88843L16.1613 9.33854L16.7112 9.88843L16.1613 10.4383L15.6114 9.88843ZM3.94477 10.6662C3.73849 10.6662 3.54066 10.5843 3.3948 10.4384C3.24894 10.2925 3.16699 10.0947 3.16699 9.88843C3.16699 9.68215 3.24894 9.48432 3.3948 9.33846C3.54066 9.1926 3.73849 9.11065 3.94477 9.11065V10.6662ZM11.4947 4.67188L16.1613 9.33854L15.0615 10.4383L10.3949 5.77165L11.4947 4.67188ZM16.1613 10.4383L11.4947 15.105L10.3949 14.0052L15.0615 9.33854L16.1613 10.4383ZM15.6114 10.6662H3.94477V9.11065H15.6114V10.6662Z\" fill=\"#787878\"/></svg></button>',\r\n            prevArrow: '<button type=\"button\" class=\"slick-prev slick-arrow-custom\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"19\" height=\"20\" viewBox=\"0 0 19 20\" fill=\"none\"><path d=\"M3.38856 9.88843L2.83867 9.33854L2.28879 9.88843L2.83867 10.4383L3.38856 9.88843ZM15.0552 10.6662C15.2615 10.6662 15.4593 10.5843 15.6052 10.4384C15.7511 10.2925 15.833 10.0947 15.833 9.88843C15.833 9.68215 15.7511 9.48432 15.6052 9.33846C15.4593 9.1926 15.2615 9.11065 15.0552 9.11065V10.6662ZM7.50534 4.67188L2.83867 9.33854L3.93845 10.4383L8.60512 5.77165L7.50534 4.67188ZM2.83867 10.4383L7.50534 15.105L8.60512 14.0052L3.93845 9.33854L2.83867 10.4383ZM3.38856 10.6662H15.0552V9.11065H3.38856V10.6662Z\" fill=\"#787878\"/></svg></button>',\r\n            responsive: [\r\n                {\r\n                    breakpoint: 768,\r\n                    settings: {\r\n                        slidesToShow: 3,\r\n                        slidesToScroll: 3\r\n                    }\r\n                },\r\n                {\r\n                    breakpoint: 992,\r\n                    settings: {\r\n                        slidesToShow: 4,\r\n                        slidesToScroll: 4\r\n                    }\r\n                }\r\n            ]\r\n        })\r\n    }\r\n\r\n        function createStarRating(rating, reviewCount = null) {\r\n            // Create the main container\r\n            const container = document.createElement('div');\r\n            container.className = 'rating-container';\r\n            \r\n            // Create stars container\r\n            const starsContainer = document.createElement('div');\r\n            starsContainer.className = 'stars';\r\n            \r\n            // Create 5 stars\r\n            for (let i = 1; i <= 5; i++) {\r\n                const star = document.createElement('div');\r\n                star.className = 'star';\r\n                \r\n                // Star SVG\r\n                const starSVG = `\r\n                    <svg viewBox=\"0 0 24 24\">\r\n                        <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\r\n                    </svg>\r\n                `;\r\n                \r\n                star.innerHTML = starSVG;\r\n                \r\n                // Calculate fill percentage for this star\r\n                let fillPercentage = 0;\r\n                \r\n                if (rating >= i) {\r\n                    // Full star\r\n                    fillPercentage = 100;\r\n                } else if (rating > i - 1) {\r\n                    // Partial star - calculate the remaining portion\r\n                    fillPercentage = (rating - (i - 1)) * 100;\r\n                }\r\n                \r\n                // Ensure percentage is between 0 and 100\r\n                fillPercentage = Math.max(0, Math.min(100, fillPercentage));\r\n                \r\n                // Debug output for testing\r\n                if (rating === 0.1 || rating === 0.9) {\r\n                    console.log(`Star ${i}, Rating: ${rating}, Fill: ${fillPercentage}%`);\r\n                }\r\n                \r\n                // Add filled portion if needed\r\n                if (fillPercentage > 0) {\r\n                    const filledStar = document.createElement('div');\r\n                    filledStar.className = 'filled';\r\n                    filledStar.style.width = `${fillPercentage}%`;\r\n                    filledStar.innerHTML = starSVG;\r\n                    star.appendChild(filledStar);\r\n                }\r\n                \r\n                starsContainer.appendChild(star);\r\n            }\r\n            \r\n            container.appendChild(starsContainer);\r\n            \r\n            // Add review count if provided\r\n            if (reviewCount !== null) {\r\n                const reviewText = document.createElement('span');\r\n                reviewText.className = 'rating-text';\r\n                reviewText.textContent = `${reviewCount} review${reviewCount !== 1 ? 's' : ''}`;\r\n                container.appendChild(reviewText);\r\n            }\r\n            \r\n            return container;\r\n        }\r\n    \r\n        function equalizeSlickSlideHeights(sliderSelector) {\r\n            let maxHeight = 0;\r\n            // Reset heights\r\n            $(`${sliderSelector} .slick-slide`).css('height', 'auto');\r\n\r\n            // Find tallest height\r\n            $(`${sliderSelector} .slick-slide`).each(function () {\r\n                const thisHeight = $(this).outerHeight();\r\n                if (thisHeight > maxHeight) {\r\n                    maxHeight = thisHeight;\r\n                }\r\n            });\r\n\r\n            // Set all slides to tallest height\r\n            $(`${sliderSelector} .slick-slide`).css('height', `${maxHeight}px`);\r\n    }\r\n\r\n    function renderBestSellers (products) {\r\n        const bestSellersContainer = document.querySelector('.best-sellers');\r\n\r\n        products?.map(product => {\r\n            const productNode = product.node;\r\n            const productContainer = document.createElement('div');\r\n            productContainer.setAttribute('data-best-seller-slide', '')\r\n            productContainer.classList.add('best-seller-product');\r\n            \r\n            const productCardBody = document.createElement('a');\r\n            productCardBody.href = productNode?.path;\r\n            productCardBody.classList.add('product-card-body');\r\n\r\n            const productImage = document.createElement('img');\r\n            productImage.src = productNode?.defaultImage?.url;\r\n            productImage.alt = productNode?.name;\r\n            productImage.classList.add('best-seller-product-image');\r\n            productCardBody.appendChild(productImage);\r\n\r\n            const productDetails = document.createElement('div');\r\n            productDetails.classList.add('product-details');\r\n\r\n            const productBrand = document.createElement('h3');\r\n            productBrand.textContent = productNode?.brand?.name;\r\n            productBrand.classList.add('brand-name');\r\n            productDetails.appendChild(productBrand);\r\n\r\n            const productSku = document.createElement('p');\r\n            productSku.textContent = productNode?.sku;\r\n            productSku.classList.add('sku');\r\n            productDetails.appendChild(productSku);\r\n\r\n            const totalRating = productNode?.reviews?.edges?.reduce((acc, review) => acc + review?.node?.rating, 0);\r\n            const averageRating = totalRating / productNode?.reviews?.edges?.length;\r\n\r\n            const productRating = createStarRating(averageRating, productNode?.reviews?.edges?.length)\r\n            productDetails.appendChild(productRating);\r\n\r\n            const productPrice = document.createElement('p');\r\n            productPrice.textContent = `$${productNode?.prices?.price?.value?.toFixed(2)}`;\r\n            productPrice.classList.add('price');\r\n            productDetails.appendChild(productPrice);\r\n\r\n            productCardBody.appendChild(productDetails);\r\n            productContainer.appendChild(productCardBody);\r\n\r\n            const productAddToCartButton = document.createElement('a');\r\n            productAddToCartButton.href = productNode?.addToCartUrl;\r\n            productAddToCartButton.classList.add('call-to-action');\r\n            productAddToCartButton.classList.add('add-to-cart');\r\n            const addToCartText = document.createElement('span');\r\n            addToCartText.textContent = 'Add to Cart';\r\n            addToCartText.classList.add('text');\r\n            productAddToCartButton.appendChild(addToCartText);\r\n            productContainer.appendChild(productAddToCartButton);\r\n\r\n            bestSellersContainer.appendChild(productContainer);\r\n\r\n        })\r\n    }\r\n\r\n    async function getBestSellers() {\r\n        const query = {\r\n            query: `{\r\n                    site {\r\n                        route(path: \"/best-sellers/\") {\r\n                            node {\r\n                                __typename\r\n                                id\r\n                                # A different response is returned based on which type of object was matched\r\n                                ... on Category {\r\n                                name\r\n                                description\r\n                                    products {\r\n                                        edges {\r\n                                            node {\r\n                                                entityId,\r\n                                                brand {\r\n                                                    name\r\n                                                },\r\n                                                sku,\r\n                                                path,\r\n                                                defaultImage {\r\n                                                    url(width: 400, height: 400)\r\n                                                },\r\n                                                reviews {\r\n                                                    edges {\r\n                                                        node {\r\n                                                        rating\r\n                                                        }\r\n                                                    }\r\n                                                },\r\n                                                prices {\r\n                                                    price {\r\n                                                        value\r\n                                                    }\r\n                                                },\r\n                                                addToCartUrl\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                \r\n            }`\r\n        };\r\n        \r\n        const context = JSON.parse({{jsContext}});\r\n        console.log('context:', context);\r\n        const graphToken = context?.token;\r\n\r\n        const [result, error] = await ApiFetch(\"POST\", \"/graphql\", query, graphToken);\r\n\r\n        if (result) {\r\n            console.log('result:', result);\r\n            renderBestSellers(result?.data?.site?.route?.node?.products?.edges);\r\n            setTimeout(() => {\r\n                initializeBestSellersSlider();\r\n                $('.best-sellers').on('setPosition', function () {\r\n                    equalizeSlickSlideHeights('.best-sellers');\r\n                });\r\n                const loadingIcon = document.querySelector('.best-sellers .icon-loading');\r\n                loadingIcon.style.display = 'none';\r\n            }, 100)\r\n        } else {\r\n            console.log('Error fetching the best seller products:', error)\r\n        }\r\n    }\r\n    \r\n    document.addEventListener(\"DOMContentLoaded\", function() {\r\n        getBestSellers();\r\n    });\r\n</script>\n"
}